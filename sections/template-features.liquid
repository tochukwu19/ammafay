<!-- Features Section Schema -->
{%- liquid
  assign section_title = section.settings.section_title | default: 'Why Hypochlorous Acid'
  assign main_heading = section.settings.main_heading | default: 'Safe enough for babies. Strong enough for you.'
  assign description = section.settings.description | default: "HOCl (Hypochlorous Acid) Is A Compound Your White Blood Cells Naturally Produce To Protect Against Germs. It's Been Used In Hospitals For Years To Clean Wounds And Support Healing — But It's Gentle Enough To Use On Your Baby's Hands, Skin, Toys, Or Anything They Put In Their Mouth."
  assign feature_section_title = section.settings.feature_section_title | default: 'Clean without compromise'
-%}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/8.4.7/swiper-bundle.min.css">

<style>
  .features-section {
    background: #f8f9fa;
  }
  
  .feature-icon-placeholder {
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    color: #6b7280;
    margin: 0 auto 1rem;
    transition: all 0.3s ease;
  }
  
  .feature-item:hover .feature-icon-placeholder {
    transform: translateY(-5px);
  }
  
  .product-carousel {
    height: inherit;
    overflow: hidden;
  }
  .swiper-pagination-bullet {
    background: rgba(255,255,255,0.5);
    opacity: 1;
  }
  
  .swiper-pagination-bullet-active {
    background: #fff;
  }
  
  .section-badge {
    font-size: 20px;
    font-weight: 500;
    margin-bottom: 1rem;
    position: relative;
    left: 60px;
  }
  
  .section-badge::before {
    content: '';
    position: absolute;
    left: -60px;
    top: 50%;
    transform: translateY(-50%);
    width: 40px;
    height: 1px;
    background: #000;
  }

  .product-carousel {
  width: 100%;
  overflow: hidden;
}

.products-swiper {
  width: 100% !important;
  height: 100%;
}

.products-swiper swiper-slide {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100% !important;
}

.products-swiper swiper-slide img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

@media (max-width: 1025px) {
  .products-swiper {
    height: 350px;
  }
}

  @media (max-width: 768px) {
    .product-carousel {
      height: 350px;
    }
    
    .section-badge::before {
      left: -35px;
      width: 30px;
    }
  }
</style>

<section id="why-hclo" class="features-section py-16 md:py-24">
  <div class="container w-[95%] md:w-[90%] mx-auto px-4">
    <div class="grid h-auto lg:h-[700px] lg:grid-cols-2 gap-12 lg:gap-16 items-center">
      
      <div class="order-2 lg:order-1">
        <div class="section-badge w-fit">{{ section_title }}</div>
        
        <h2 class="kefir text-2xl md:text-3xl lg:text-4xl font-bold text-gray-900 mb-6 leading-tight">
          {{ main_heading }}
        </h2>
        
        <p class="text-lg mb-12">
          {{ description }}
        </p>
        
        <div class="mb-8">
          <h3 class="kefir text-2xl font-bold text-gray-900 mb-8">{{ feature_section_title }}</h3>
          
          <div class="grid relative md:left-[-20px] grid-cols-2 md:grid-cols-3 gap-8">
            {% for block in section.blocks %}
              {% case block.type %}
                {% when 'feature' %}
                  <div class="feature-item text-center">
                    <div class="feature-icon-placeholder">
                      {% if block.settings.icon_image %}
                        <img src="{{ block.settings.icon_image | image_url: width: 40 }}" 
                             alt="{{ block.settings.title }}" 
                             class="w-8 h-8 object-contain">
                      {% else %}
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                      {% endif %}
                    </div>
                    
                    <h4 class="font-[500] capitalize text-base">
                      {{ block.settings.title | default: 'Feature Title' }}
                    </h4>
                    
                    {% if block.settings.description %}
                      <p class="text-sm text-gray-600 mt-2">{{ block.settings.description }}</p>
                    {% endif %}
                  </div>
              {% endcase %}
            {% endfor %}
          </div>
        </div>
      </div>
      
      <div class="order-2 h-full hidden md:block">
        <div class="product-carousel">
            <swiper-container class="products-swiper" init="false">
                {% assign carousel_images = section.blocks | where: 'type', 'carousel_image' %}
                {% if carousel_images.size > 0 %}
                {% for block in carousel_images %}
                    <swiper-slide>
                    {% if block.settings.image %}
                        <img src="{{ block.settings.image | image_url: width: 600, height: 500 }}"
                            alt="{{ block.settings.alt_text | default: 'Product image' }}"
                            loading="lazy">
                    {% else %}
                        <div class="w-full h-full bg-gradient-to-br from-blue-100 to-purple-100 flex items-center justify-center">
                        <div class="text-center text-gray-500">
                            <svg class="w-20 h-20 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                            <p class="text-lg font-medium">Product Image {{ forloop.index }}</p>
                            <p class="text-sm text-gray-400 mt-1">Add image in theme editor</p>
                        </div>
                        </div>
                    {% endif %}
                    </swiper-slide>
                {% endfor %}
                {% else %}
                {% for i in (1..3) %}
                    <swiper-slide>
                    <div class="w-full h-full bg-gradient-to-br from-blue-100 to-purple-100 flex items-center justify-center">
                        <div class="text-center text-gray-500">
                        <svg class="w-20 h-20 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                        <p class="text-lg font-medium">Product Image {{ i }}</p>
                        <p class="text-sm text-gray-400 mt-1">Add carousel images in theme editor</p>
                        </div>
                    </div>
                    </swiper-slide>
                {% endfor %}
                {% endif %}
            </swiper-container>
        </div>
      </div>
      
    </div>
  </div>
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/8.4.7/swiper-bundle.min.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    setTimeout(() => {
      const swiperContainer = document.querySelector('.products-swiper');
      if (!swiperContainer) return;
      
      const params = {
        loop: true,
        autoplay: {
          delay: 2000,
          disableOnInteraction: false,
        },
        speed: 1000,
        effect: 'fade',
        fadeEffect: {
          crossFade: true
        },
        pagination: {
          el: '.swiper-pagination',
          clickable: true,
          dynamicBullets: true,
        },
        // Fix for mobile overflow
        slidesPerView: 1,
        spaceBetween: 0,
        centeredSlides: true,
        watchOverflow: true,
      };
      
      Object.assign(swiperContainer, params);
      swiperContainer.initialize();
      
      // Wait for initialization then add hover events
      setTimeout(() => {
        if (swiperContainer.swiper) {
          swiperContainer.addEventListener('mouseenter', () => {
            swiperContainer.swiper.autoplay.stop();
          });
          
          swiperContainer.addEventListener('mouseleave', () => {
            swiperContainer.swiper.autoplay.start();
          });
        }
      }, 200);
    }, 100);
  });
</script>

<!-- Section Schema -->
{% schema %}
{
  "name": "Features with Carousel",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "section_title",
      "label": "Section Badge Text",
      "default": "Why Hypochlorous Acid"
    },
    {
      "type": "text",
      "id": "main_heading",
      "label": "Main Heading",
      "default": "Safe enough for babies. Strong enough for you."
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "HOCl (Hypochlorous Acid) Is A Compound Your White Blood Cells Naturally Produce To Protect Against Germs. It's Been Used In Hospitals For Years To Clean Wounds And Support Healing — But It's Gentle Enough To Use On Your Baby's Hands, Skin, Toys Or Anything They Put In Their Mouth."
    },
    {
      "type": "text",
      "id": "feature_section_title",
      "label": "Features Section Title",
      "default": "Clean without compromise"
    }
  ],
  "blocks": [
    {
      "type": "feature",
      "name": "Feature",
      "settings": [
        {
          "type": "image_picker",
          "id": "icon_image",
          "label": "Feature Icon"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Feature Title"
        },
        {
          "type": "text",
          "id": "description",
          "label": "Feature Description (Optional)"
        }
      ]
    },
    {
      "type": "carousel_image",
      "name": "Carousel Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Product Image"
        },
        {
          "type": "text",
          "id": "alt_text",
          "label": "Image Alt Text"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Features with Carousel",
      "blocks": [
        {
          "type": "feature",
          "settings": {
            "title": "100% Natural"
          }
        },
        {
          "type": "feature",
          "settings": {
            "title": "0+ Months"
          }
        },
        {
          "type": "feature",
          "settings": {
            "title": "Non-Toxic"
          }
        },
        {
          "type": "feature",
          "settings": {
            "title": "Additive Free"
          }
        },
        {
          "type": "feature",
          "settings": {
            "title": "Alcohol Free"
          }
        },
        {
          "type": "feature",
          "settings": {
            "title": "Earth Friendly"
          }
        },
        {
          "type": "carousel_image"
        },
        {
          "type": "carousel_image"
        },
        {
          "type": "carousel_image"
        }
      ]
    }
  ]
}
{% endschema %}